# MES 项目管理规范（初版）

## 1. 分支管理

- `main`：生产分支，仅允许通过 PR 合并。
- `develop`：日常集成分支。
- `feature/*`：功能开发分支。
- `hotfix/*`：生产紧急修复分支。

## 2. 提交规范

建议采用 Conventional Commits：

- `feat:` 新功能
- `fix:` 缺陷修复
- `refactor:` 重构
- `docs:` 文档
- `test:` 测试
- `chore:` 构建或工具变更

示例：

```text
feat(order): add production order release workflow
fix(first-article): prevent duplicate submit in pending status
docs: update database design for order status log
```

## 3. PR 规范

- PR 标题明确模块与变更类型。
- 每个 PR 聚焦单一主题，避免“大杂烩”。
- 至少 1 人评审通过后合并。
- 合并前必须通过自动化检查（lint/test）。

## 4. 代码规范

### 后端（FastAPI）

- 分层清晰：`api -> service -> repository`。
- 路由层不写复杂业务逻辑。
- 统一异常处理与错误码返回。
- 所有写接口必须记录审计日志。

### 前端（Flutter）

- 页面与状态管理分离。
- 统一 API 封装，不在页面直接拼接请求。
- 表单校验前置，错误提示统一风格。

## 5. 测试规范

- 单元测试：核心服务层逻辑必须覆盖。
- 集成测试：登录、订单、首件主流程必须覆盖。
- 回归测试：每次发布前执行关键业务用例。

## 6. 发布规范

- 发布前检查项：
  - 数据库迁移脚本已验证。
  - 配置文件已区分环境。
  - 回滚方案已准备。
- 发布后检查项：
  - 关键接口健康检查。
  - 错误日志与性能监控。
  - 用户验收确认。
