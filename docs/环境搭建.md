# MES 环境搭建与启动指南（初版）

## 1. 开发环境要求

- Python 3.11+
- Flutter 3.24+（含 Dart SDK）
- PostgreSQL 14+
- Git 2.40+

## 2. 后端环境搭建（FastAPI）

```powershell
# 1) 创建虚拟环境
python -m venv .venv

# 2) 激活虚拟环境（PowerShell）
.\.venv\Scripts\Activate.ps1

# 3) 安装依赖（示例）
pip install fastapi uvicorn sqlalchemy alembic psycopg2-binary pydantic-settings python-jose passlib[bcrypt]
```

## 3. PostgreSQL 初始化（示例）

```sql
CREATE DATABASE mes_db;
CREATE USER mes_user WITH PASSWORD 'mes_password';
GRANT ALL PRIVILEGES ON DATABASE mes_db TO mes_user;
```

## 4. 后端配置建议

创建 `.env`（仅示例）：

```env
APP_NAME=MES
APP_ENV=dev
DB_HOST=127.0.0.1
DB_PORT=5432
DB_NAME=mes_db
DB_USER=mes_user
DB_PASSWORD=mes_password
JWT_SECRET_KEY=replace_with_strong_secret
JWT_ALGORITHM=HS256
JWT_EXPIRE_MINUTES=120
```

## 5. 数据迁移与启动（示例）

```powershell
# 初始化迁移（首次）
alembic init alembic

# 生成迁移
alembic revision --autogenerate -m "init tables"

# 执行迁移
alembic upgrade head

# 启动服务
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

接口文档地址：

- Swagger UI: `http://127.0.0.1:8000/docs`
- ReDoc: `http://127.0.0.1:8000/redoc`

## 6. 前端环境搭建（Flutter）

```powershell
# 检查 Flutter 环境
flutter doctor

# 创建项目（如需）
flutter create mes_client

# 安装依赖
cd mes_client
flutter pub get

# 启动（示例）
flutter run -d chrome
```

## 7. 前后端联调建议

- 前端配置 API Base URL，如 `http://127.0.0.1:8000/api/v1`。
- 统一时区与日期格式（建议后端返回 ISO8601）。
- 联调前冻结接口字段，减少反复修改。

## 8. 常见问题

- 连接数据库失败：检查 PostgreSQL 监听地址、端口和账号权限。
- Flutter 运行失败：先执行 `flutter doctor` 并按提示修复。
- 跨域问题：后端启用 CORS 中间件并配置允许来源。
