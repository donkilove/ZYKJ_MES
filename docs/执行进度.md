# MES 执行进度

## 2026-02-25

### Sprint 1 完成状态

- 状态：已完成闭环，可演示。
- 范围：
  - 项目脚手架初始化（前后端目录结构、依赖、启动入口）。
  - JWT 登录鉴权与权限控制。
  - 用户管理基础能力（查询、新增、详情、更新）。
  - Flutter 登录页与用户管理页初版。

### 本次新增落地（角色与工序管理）

- 角色体系固定为 4 类：
  - 系统管理员角色（`system_admin`）
  - 生产管理员角色（`production_admin`）
  - 品质管理员角色（`quality_admin`）
  - 操作员角色（`operator`）
- 新增工序模型与接口：
  - `GET /api/v1/processes`
  - `POST /api/v1/processes`
  - `PUT /api/v1/processes/{id}`
- 用户规则增强：
  - 每个账号必须分配至少一个角色。
  - 操作员角色必须由系统管理员分配至少一个工序。
  - 非操作员角色不允许绑定工序。
  - 新增删除用户能力（`DELETE /api/v1/users/{id}`）。
- 初始化脚本增强：
  - 自动创建 4 个固定角色。
  - 自动创建默认工序（激光打标、产品测试、产品组装、产品包装）。
  - 自动重置 `admin` 账号为系统管理员角色。
- 账号禁用功能移除：
  - 删除用户启停接口 `PATCH /users/{id}/status`。
  - 登录不再进行“禁用状态”拦截。
  - 前端移除启停按钮。

### 前端页面增强

- 用户管理页支持：
  - 角色多选分配。
  - 工序多选分配。
  - 操作员工序必填校验。
- 列表展示角色名称与工序名称。
- UI 文案已统一中文。

### 校验结果

- 后端校验通过：
  - 4 个角色与默认工序正确初始化。
  - 操作员无工序创建返回 400。
  - 非操作员分配工序返回 400。
  - 用户状态接口已移除（404）。
- 前端校验通过：
  - `flutter analyze` 无问题。
  - `flutter build windows --debug` 构建成功。

### 下一步（Sprint 2）

- 产品管理 API 与页面。
- 产品参数模板与参数项 API 与页面。
- 数据校验与唯一约束完善。
- 增加后端自动化测试用例。
